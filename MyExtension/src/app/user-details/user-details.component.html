<h2 *ngIf="userInfo">Task History for {{ userInfo.username }}</h2>

<input type="text" placeholder="Search task..." [(ngModel)]="searchTerm" class="search-input" />

<div *ngIf="errorMessage" class="error">
  <p>{{ errorMessage }}</p>
</div>

<div class="navigation">
  <button (click)="goToAdminDashboard()">Previous</button>
</div>

<div *ngIf="getMonthKeys().length === 0 && !errorMessage">
  <p>No task history found for this user.</p>
</div>

<!-- Loop over each month -->
<div *ngFor="let month of getMonthKeys()">
  <h4>{{ month }}</h4>

  <table *ngIf="getFilteredTasksForMonth(month).length > 0">
    <thead>
      <tr>
        <th>Date</th>
        <th>Task Name</th>
        <th>Total Duration</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of getFilteredTasksForMonth(month); trackBy: trackByTask">
        <td>{{ item.date }}</td>
        <td>{{ item.taskName }}</td>
        <td>{{ item.totalDuration }}</td>
      </tr>
    </tbody>
  </table>

  <div class="monthly-summary" *ngIf="getFilteredTasksForMonth(month).length > 0">
    <strong>Monthly Total: {{ formatDuration(monthlyTotals[month]) }}</strong>
  </div>
</div>

<!-- Optional: Total lunch break duration -->
<div *ngIf="lunchBreakTotal" class="lunch-summary">
  <strong>Total Lunch Break Time: {{ lunchBreakTotal }}</strong>
</div>
